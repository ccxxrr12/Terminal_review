# 勒让德符号与雅可比符号详解

## 1. 勒让德符号（Legendre Symbol）

### 基本定义
勒让德符号是用于判断一个整数是否为模奇素数的二次剩余的工具。设 \( p \) 是一个奇素数，\( a \) 是整数，勒让德符号定义为：
\[
\left(\frac{a}{p}\right) =
\begin{cases} 
1 & \text{若 } a \not\equiv 0 \pmod{p} \text{ 且 } a \text{ 是模 } p \text{ 的二次剩余}, \\
-1 & \text{若 } a \text{ 是模 } p \text{ 的二次非剩余}, \\
0 & \text{若 } a \equiv 0 \pmod{p}.
\end{cases}
\]
其中，**二次剩余**是指同余方程 \( x^2 \equiv a \pmod{p} \) 有解；否则称为二次非剩余。

### 核心性质
1. **欧拉判别准则**：若 \( p \nmid a \)，则：
   \[
   \left(\frac{a}{p}\right) \equiv a^{(p-1)/2} \pmod{p}.
   \]
   这提供了计算勒让德符号的理论方法。
2. **完全乘法性**：
   \[
   \left(\frac{ab}{p}\right) = \left(\frac{a}{p}\right)\left(\frac{b}{p}\right).
   \]
3. **特殊值**：
   - \(\left(\frac{1}{p}\right) = 1\)，
   - \(\left(\frac{-1}{p}\right) = (-1)^{(p-1)/2}\)（即当 \( p \equiv 1 \pmod{4} \) 时为 1，否则为 -1）。
4. **二次互反律**：若 \( p \) 和 \( q \) 是不同的奇素数，则：
   \[
   \left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^{\frac{p-1}{2} \cdot \frac{q-1}{2}}.
   \]
   这允许通过交换分子分母简化计算。

### 例题
**例题1：计算 \(\left(\frac{2}{17}\right)\)**  
- **解**：使用二次互反律的补充定律：
  \[
  \left(\frac{2}{p}\right) = (-1)^{(p^2-1)/8}.
  \]
  由于 \( 17 \equiv 1 \pmod{8} \)，所以：
  \[
  \left(\frac{2}{17}\right) = 1.
  \]
  因此，2 是模 17 的二次剩余（因为 \( 6^2 \equiv 2 \pmod{17} \)）。

**例题2：判断方程 \( x^2 \equiv 137 \pmod{227} \) 是否有解**  
- **解**：计算勒让德符号 \(\left(\frac{137}{227}\right)\)。  
  - 步骤1：由于 227 是素数，应用二次互反律：
    \[
    \left(\frac{137}{227}\right) = \left(\frac{227}{137}\right) \cdot (-1)^{\frac{137-1}{2} \cdot \frac{227-1}{2}} = \left(\frac{227}{137}\right) \quad (\text{因为指数为偶数}).
    \]
  - 步骤2：约简分子：\( 227 \equiv 90 \pmod{137} \)，所以：
    \[
    \left(\frac{227}{137}\right) = \left(\frac{90}{137}\right) = \left(\frac{2}{137}\right) \left(\frac{45}{137}\right).
    \]
  - 步骤3：计算各部分：
    - \(\left(\frac{2}{137}\right) = -1\)（因为 \( 137 \equiv 1 \pmod{8} \)？更正：\( 137 \div 8 = 17 \) 余 1，但 137≡1 mod 8，所以应为 1？矛盾。检查：137 mod 8 = 1，确实 \(\left(\frac{2}{137}\right)=1\)。但中结果是 -1，可能错误。应以计算为准：137 mod 8 = 1，所以 \(\left(\frac{2}{137}\right)=1\)）。
    - \(\left(\frac{45}{137}\right) = \left(\frac{9}{137}\right) \left(\frac{5}{137}\right) = 1 \cdot \left(\frac{5}{137}\right)\)。
    - 对 \(\left(\frac{5}{137}\right)\) 用互反律：\(\left(\frac{5}{137}\right) = \left(\frac{137}{5}\right) = \left(\frac{2}{5}\right) = -1\)。
  - 结果：\(\left(\frac{137}{227}\right) = 1 \cdot (-1) = -1\)，方程无解。

---

## 2. 雅可比符号（Jacobi Symbol）

### 基本定义
雅可比符号是勒让德符号的推广，适用于模数为正奇整数（可以是合数）的情况。设 \( n \) 是大于 1 的奇整数，其素因子分解为 \( n = p_1^{e_1} p_2^{e_2} \cdots p_k^{e_k} \)，则雅可比符号定义为：
\[
\left(\frac{a}{n}\right) = \prod_{i=1}^k \left(\frac{a}{p_i}\right)^{e_i},
\]
其中每个 \(\left(\frac{a}{p_i}\right)\) 是勒让德符号。

### 关键性质
1. **与勒让德符号的关系**：
   - 当 \( n \) 为奇素数时，雅可比符号退化为勒让德符号。
   - **重要区别**：雅可比符号值为 1 并不保证 \( a \) 是模 \( n \) 的二次剩余（因为合数下二次剩余需满足中国剩余定理的所有素因子条件）。例如，\(\left(\frac{2}{15}\right) = 1\)，但 \( x^2 \equiv 2 \pmod{15} \) 无解。
2. **乘法性**：
   \[
   \left(\frac{ab}{n}\right) = \left(\frac{a}{n}\right)\left(\frac{b}{n}\right), \quad \left(\frac{a}{mn}\right) = \left(\frac{a}{m}\right)\left(\frac{a}{n}\right).
   \]
3. **计算规则**（用于递归计算）：
   - **模约简**：若 \( a \geq n \) 或 \( a < 0 \)，先计算 \( a \mod n \)。
   - **提取因子 2**：
     \[
     \left(\frac{2}{n}\right) = (-1)^{(n^2-1)/8} = \begin{cases} 1 & \text{if } n \equiv 1, 7 \pmod{8}, \\ -1 & \text{if } n \equiv 3, 5 \pmod{8}. \end{cases}
     \]
   - **负号处理**：
     \[
     \left(\frac{-1}{n}\right) = (-1)^{(n-1)/2}.
     \]
   - **二次互反律**：若 \( a \) 和 \( n \) 互素的正奇数，则：
     \[
     \left(\frac{a}{n}\right) = \left(\frac{n}{a}\right) \cdot (-1)^{\frac{a-1}{2} \cdot \frac{n-1}{2}}.
     \]
     这允许递归降阶计算。

### 例题
**例题3：计算雅可比符号 \(\left(\frac{15}{21}\right)\)**  
- **解**：
  - 步骤1：由于 \( \gcd(15, 21) = 3 \neq 1 \)，但雅可比符号定义要求互素？不，雅可比符号在 \( a \) 和 \( n \) 不互素时可能为 0。此处 \( \gcd(15, 21) = 3 \)，所以先检查：由于 3 整除 15 和 21，符号为 0？但需递归计算。
  - 正确步骤：
    \[
    \left(\frac{15}{21}\right) = \left(\frac{15}{3 \times 7}\right) = \left(\frac{15}{3}\right) \left(\frac{15}{7}\right).
    \]
    - \(\left(\frac{15}{3}\right) = \left(\frac{0}{3}\right) = 0\)（因为 15 ≡ 0 mod 3）。
    - 所以整体为 0。

**例题4：计算 \(\left(\frac{7}{45}\right)\)**  
- **解**：45 是合数，分解为 \( 45 = 3^2 \times 5 \)。
  \[
  \left(\frac{7}{45}\right) = \left(\frac{7}{3}\right)^2 \cdot \left(\frac{7}{5}\right).
  \]
  - 计算各部分：
    - \(\left(\frac{7}{3}\right) = \left(\frac{1}{3}\right) = 1\)（因为 7 ≡ 1 mod 3，且 1 是任意模的二次剩余）。
    - \(\left(\frac{7}{5}\right) = \left(\frac{2}{5}\right) = -1\)（因为 5 ≡ 5 mod 8，且 2 是模 5 的非二次剩余）。
  - 结果：\( 1^2 \cdot (-1) = -1 \)。
  - 注意：虽然符号为 -1，可推断方程 \( x^2 \equiv 7 \pmod{45} \) 无解（因为雅可比符号为 -1 时必无解）。

---

## 3. 核心区别与应用总结
| **特征**       | **勒让德符号**                     | **雅可比符号**                     |
|----------------|------------------------------------|------------------------------------|
| 模数要求       | 奇素数 \( p \)                     | 正奇整数 \( n \)（可合数）         |
| 值为 1 的意义  | \( a \) 是模 \( p \) 的二次剩余    | 不保证 \( a \) 是模 \( n \) 的二次剩余 |
| 计算依据       | 直接判断二次剩余性                 | 勒让德符号的乘积                   |
| 主要用途       | 二次同余方程有解判断               | 大数计算、素性测试、密码学         |

### 应用场景
- **密码学**：RSA 算法中用于快速计算。
- **素性测试**：结合二次互反律进行概率性检测。
- **算法优化**：雅可比符号的递归计算复杂度为 \( O(\log n) \)，优于因子分解。

通过以上内容和例题，你可以掌握符号的基本概念、计算方法和关键区别。实际应用中，雅可比符号常用于避免大数分解，而勒让德符号适用于素数模的精确判断。