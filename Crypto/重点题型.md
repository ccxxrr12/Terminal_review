### **考点一：辗转相除法（欧几里得算法）**

**核心知识点：**
1.  **目的**：计算两个整数的最大公因数 `(a, b)`。
2.  **扩展欧几里得算法**：在求得最大公因数 `d = (a, b)` 的同时，找到整数 `s` 和 `t`，使得 `d = s·a + t·b`。这个等式在密码学（如RSA算法）中至关重要。
3.  **过程**：通过一系列带余除法，将问题规模逐步缩小，然后反向代入，求出 `s` 和 `t`。

**例题1：计算 (239, 37)，并求 s, t ∈ Z，使得 (239, 37) = s·239 + t·37。**

**详细解析：**
1.  **进行辗转相除：**
    *   `239 ÷ 37 = 6 ... 17` → `239 = 6 * 37 + 17`
    *   `37 ÷ 17 = 2 ... 3`  → `37 = 2 * 17 + 3`
    *   `17 ÷ 3 = 5 ... 2`   → `17 = 5 * 3 + 2`
    *   `3 ÷ 2 = 1 ... 1`    → `3 = 1 * 2 + 1`
    *   `2 ÷ 1 = 2 ... 0`    → `2 = 2 * 1 + 0`
    *   当余数为0时，**上一个余数** `1` 即为最大公因数。所以 `(239, 37) = 1`。

2.  **反向代入，求解 s 和 t：**
    *   从倒数第二个等式开始：`1 = 3 - 1 * 2`。 **(1)**
    *   用上一个等式 `2 = 17 - 5 * 3` 代入 **(1)** 式，消去 `2`：
        `1 = 3 - 1 * (17 - 5 * 3) = -1 * 17 + 6 * 3`。 **(2)**
    *   用等式 `3 = 37 - 2 * 17` 代入 **(2)** 式，消去 `3`：
        `1 = -1 * 17 + 6 * (37 - 2 * 17) = 6 * 37 - 13 * 17`。 **(3)**
    *   用第一个等式 `17 = 239 - 6 * 37` 代入 **(3)** 式，消去 `17`：
        `1 = 6 * 37 - 13 * (239 - 6 * 37) = -13 * 239 + 84 * 37`。

3.  **结论：**
    *   最大公因数 `(239, 37) = 1`。
    *   系数 `s = -13`, `t = 84`。验证：`(-13)*239 + 84*37 = -3107 + 3108 = 1`。

**例题2：计算 (-7641, 243)，并求 s, t ∈ Z，使得 (-7641, 243) = s(-7641) + t·243。**

**详细解析：**
*   **关键点**：最大公因数与符号无关，即 `(-a, b) = (a, b)`。所以我们先计算 `(7641, 243)`。
*   **进行辗转相除：**
    *   `7641 ÷ 243 = 31 ... 108` → `7641 = 31 * 243 + 108`
    *   `243 ÷ 108 = 2 ... 27`   → `243 = 2 * 108 + 27`
    *   `108 ÷ 27 = 4 ... 0`     → `108 = 4 * 27 + 0`
    *   最大公因数为 `27`，所以 `(-7641, 243) = 27`。
*   **反向代入，求解 s 和 t：**
    *   `27 = 243 - 2 * 108`。
    *   代入 `108 = 7641 - 31 * 243`：
        `27 = 243 - 2 * (7641 - 31 * 243) = -2 * 7641 + 63 * 243`。
*   **结论：**
    *   因为原题是 `-7641`，所以 `s = 2`（因为 `s * (-7641) = 2 * (-7641) = -2 * 7641`）。
    *   `t = 63`。
    *   文档中答案 `t=62` 疑似笔误，应为 `t=63`。

---

### **考点二：三大定理的计算**

**核心知识点：**
1.  **欧拉定理**：若 `(a, m) = 1`，则 `a^φ(m) ≡ 1 (mod m)`。其中 `φ(m)` 是欧拉函数，表示小于 `m` 且与 `m` 互素的正整数个数。
2.  **费马小定理**：欧拉定理的特例。若 `p` 是素数，则对于任意整数 `a`，有 `a^p ≡ a (mod p)`。若 `(a, p)=1`，则可写为 `a^(p-1) ≡ 1 (mod p)`。
3.  **威尔逊定理**：若 `p` 是素数，则 `(p-1)! ≡ -1 (mod p)`。

**例题1：计算 5^1024 (mod 7)。**

**详细解析：**
*   因为 7 是素数，且 `(5, 7)=1`，适用费马小定理：`5^6 ≡ 1 (mod 7)`。
*   将指数 `1024` 对 `6` 取模：`1024 ÷ 6 = 170 ... 4`，即 `1024 ≡ 4 (mod 6)`。
*   所以 `5^1024 ≡ 5^4 (mod 7)`。
*   计算 `5^4 = 625`，`625 ÷ 7 = 89 ... 2`。所以 `5^1024 ≡ 2 (mod 7)`。

**例题2：计算 22! (mod 23)。**

**详细解析：**
*   因为 23 是素数，直接应用威尔逊定理：`22! ≡ -1 (mod 23)`。

---

### **考点三：中国剩余定理求解一次同余方程组**

**核心知识点：**
1.  **适用条件**：方程组中的模数 `m1, m2, ..., mk` 必须**两两互素**。
2.  **求解步骤**：
    *   **步骤一**：确保每个方程都是 `x ≡ ai (mod mi)` 的形式。如果不是，需要通过乘逆元进行转化。
    *   **步骤二**：计算 `M = m1 * m2 * ... * mk`。
    *   **步骤三**：对每个 `i`，计算 `Mi = M / mi`。
    *   **步骤四**：对每个 `i`，计算 `Mi'`，即 `Mi` 在模 `mi` 下的逆元（满足 `Mi * Mi' ≡ 1 (mod mi)`）。
    *   **步骤五**：方程组的唯一解为 `x ≡ a1*M1*M1' + a2*M2*M2' + ... + ak*Mk*Mk' (mod M)`。

**例题：求解同余方程组**
```
x ≡ 1 (mod 3)
3x ≡ 2 (mod 5)
x ≡ 3 (mod 7)
```

**详细解析：**
1.  **标准化方程**：第二个方程 `3x ≡ 2 (mod 5)` 需要转化。求 `3` 在模 `5` 下的逆元，因为 `3*2=6≡1(mod5)`，所以逆元为 `2`。方程两边同乘 `2`：`x ≡ 4 (mod 5)`。标准化后的方程组为：
    ```
    x ≡ 1 (mod 3)
    x ≡ 4 (mod 5)
    x ≡ 3 (mod 7)
    ```

2.  **计算中间量**：
    *   `M = 3 * 5 * 7 = 105`。
    *   `M1 = 105 / 3 = 35`, `M2 = 105 / 5 = 21`, `M3 = 105 / 7 = 15`。
    *   求逆元：
        *   `M1'`：求 `35 ≡ 2 (mod 3)` 的逆元。`2*2=4≡1(mod3)`，所以 `M1' = 2`（或等价地 `-1`）。
        *   `M2'`：求 `21 ≡ 1 (mod 5)` 的逆元。`1*1=1≡1(mod5)`，所以 `M2' = 1`。
        *   `M3'`：求 `15 ≡ 1 (mod 7)` 的逆元。`1*1=1≡1(mod7)`，所以 `M3' = 1`。

3.  **代入公式求解**：
    `x ≡ 1 * 35 * 2 + 4 * 21 * 1 + 3 * 15 * 1 (mod 105)`
    `x ≡ 70 + 84 + 45 (mod 105)`
    `x ≡ 199 (mod 105)`
    `x ≡ 199 - 105*1 ≡ 94 (mod 105)`。

4.  **结论**：方程组的解为 `x ≡ 94 (mod 105)`。

---

### **考点四：二次剩余的判定和勒让德符号的计算**

**核心知识点：**
1.  **二次剩余**：若同余方程 `x² ≡ a (mod p)` 有解（`p` 为奇素数），则称 `a` 是模 `p` 的二次剩余；否则为二次非剩余。
2.  **勒让德符号** `(a/p)`：用于快速判定。
    *   `(a/p) = 1`：`a` 是模 `p` 的二次剩余。
    *   `(a/p) = -1`：`a` 是模 `p` 的二次非剩余。
    *   `(a/p) = 0`：`p | a`。
3.  **计算性质（核心公式）**：
    *   `(ab/p) = (a/p)(b/p)`
    *   `(a/p) = (a mod p / p)`
    *   `(-1/p) = (-1)^((p-1)/2)`
    *   `(2/p) = (-1)^((p²-1)/8)`
    *   **二次互反律**：若 `p, q` 均为奇素数，则 `(p/q)(q/p) = (-1)^((p-1)/2 * (q-1)/2)`。

**例题1：判定 x² ≡ 3 (mod 119) 是否有解。**

**详细解析：**
*   **关键陷阱**：`119` 不是素数，是合数 `119=7*17`。不能直接计算雅可比符号 `(3/119)`，因为它为 `1` 不代表一定有解。
*   **正确方法**：原方程有解 ⇔ 方程组 `x² ≡ 3 (mod 7)` 和 `x² ≡ 3 (mod 17)` **同时有解**。
*   **分别计算勒让德符号**：
    *   模 `7`：`(3/7)`。用二次互反律，`(3/7) = (7/3) * (-1)^((3-1)/2*(7-1)/2) = (7/3) * (-1)^(1*3) = (1/3) * (-1) = 1 * (-1) = -1`。所以模 `7` 无解。
    *   既然模 `7` 的方程已经无解，整个方程组就无解。因此原方程 `x² ≡ 3 (mod 119)` **无解**。

**例题2：计算勒让德符号 (194/1901)。**

**详细解析（过程见文档，此处为思路梳理）：**
1.  **分解分子**：`(194/1901) = (2/1901) * (97/1901)`。
2.  **计算 `(2/1901)`**：使用公式 `(2/p)=(-1)^((p²-1)/8)`。`(1901²-1)/8` 是偶数，所以 `(2/1901)=1`。*（文档中计算为 `-1`，疑似笔误，应为 `1`）*
3.  **计算 `(97/1901)`**：使用二次互反律。`(97/1901) = (1901/97)`，因为 `(97-1)/2 * (1901-1)/2` 是偶数。
4.  **化简**：`1901 mod 97 = 58`，所以 `(1901/97) = (58/97)`。
5.  **继续分解和互反**：`(58/97) = (2/97) * (29/97)`。重复应用公式和互反律，最终计算出结果为 `1`。

---

### **考点五：求原根**

**核心知识点：**
1.  **原根**：若整数 `g` 模 `m` 的阶（满足 `g^k ≡ 1 (mod m)` 的最小正整数 `k`）等于 `φ(m)`，则 `g` 是模 `m` 的一个原根。
2.  **求模素数 `p` 的原根**：试探法。对 `p-1` 的所有素因数 `q`，检验 `g^((p-1)/q) ≢ 1 (mod p)`，若均成立，则 `g` 是原根。
3.  **求模 `p^α` 的原根**：若 `g` 是模 `p` 的原根，只需检验 `g^(p-1) ≢ 1 (mod p²)`。若成立，则 `g` 也是模 `p^α`（α≥2）的原根；若不成立，则 `g+p` 是。
4.  **求模 `2p^α` 的原根**：若 `g` 是模 `p^α` 的原根，且 `g` 是奇数，则 `g` 也是模 `2p^α` 的原根。

**例题：求模31, 模31², 模2×31³的所有原根。**

**详细解析：**
1.  **求模 `p=31` 的原根**：
    *   `φ(31)=30=2*3*5`。
    *   试探 `g=2`：`2^(30/2)=2^15 ≡ 1 (mod 31)`，不满足条件，故不是原根。
    *   试探 `g=3`：
        *   `3^(30/2)=3^15 ≡ -1 ≢ 1 (mod 31)`
        *   `3^(30/3)=3^10 ≡ 25 ≢ 1 (mod 31)`
        *   `3^(30/5)=3^6 ≡ 16 ≢ 1 (mod 31)`
        *   所有检验均通过，故 `g=3` 是模 `31` 的一个原根。
2.  **求模 `31²=961` 的原根**：
    *   检验 `3^(30) mod 961`。计算得 `3^30 ≡ 528 ≢ 1 (mod 961)`。
    *   根据定理，`g=3` 也是模 `961` 的原根。
3.  **求模 `31³` 的原根**：
    *   因为 `3` 是模 `31²` 的原根，根据定理，它自然也是模 `31^α`（α≥3）的原根。
4.  **求模 `2×31³` 的原根**：
    *   因为 `3` 是模 `31³` 的原根，且是奇数，所以 `3` 也是模 `2×31³` 的原根。
5.  **所有原根**：一旦找到一个原根 `g`，所有与 `φ(m)` 互素的 `k`，对应的 `g^k` 都是原根。

---

### **考点六：有限域的综合应用和计算**

**核心知识点：**
1.  **有限域的构造**：通过不可约多项式 `m(x)` 构造 `F_p[x] / <m(x)>`，该域有 `p^n` 个元素（`n` 为 `m(x)` 的次数）。
2.  **元素表示**：域中元素是次数小于 `n` 的多项式，表示为这些多项式模 `m(x)` 的剩余类。**规范写法**是加上上划线 `¯` 以示区别。
3.  **运算规则**：加法和乘法在 `F_p[x]` 中进行，然后模 `m(x)` 化简。系数运算需模 `p`。

**例题：设 m(x) = x³ + 2x + 2 ∈ F₃[x]**
1.  证明 `m(x)` 在 `F₃` 上不可约。
2.  构造 `F_{27} = F₃[x] / <m(x)>`，写出所有元素。
3.  计算 `(x²+1) · (2x²+2x+1)`。
4.  计算 `(x²+x+1)^(-1)`。
5.  计算 `x^29`。

**详细解析：**
1.  **证明不可约**：`m(x)` 是3次多项式，若可约必有一次因式（即有根）。检验 `F₃={0,1,2}`：
    *   `m(0)=2`, `m(1)=1+2+2=5≡2`, `m(2)=8+4+2=14≡2`。均不为0，故无根，因此不可约。
2.  **构造域和元素**：域中元素为所有次数小于3的多项式：`{ax²+bx+c | a,b,c ∈ F₃}`。共27个。
3.  **乘法计算**：
    *   在 `F₃[x]` 中计算：`(x²+1)(2x²+2x+1) = 2x⁴ + 2x³ + 2x + 1`。
    *   用 `m(x) = x³ + 2x + 2` 做带余除法（注意系数模3）：
        *   `2x⁴ + 2x³ + 2x + 1` 除以 `x³ + 0x² + 2x + 2`。
        *   商 `2x`，得到 `2x*(x³+2x+2) = 2x⁴ + 4x² + 4x ≡ 2x⁴ + x² + x (mod 3)`。
        *   相减得余数：`(2x⁴+2x³+2x+1) - (2x⁴+0x³+x²+x) = 2x³ - x² + x + 1 ≡ 2x³ + 2x² + x + 1 (mod 3)`。
        *   再用 `2` 乘 `m(x)`：`2*(x³+2x+2) = 2x³ + 4x + 4 ≡ 2x³ + x + 1 (mod 3)`。
        *   相减得最终余数：`(2x³+2x²+x+1) - (2x³+0x²+x+1) = 2x²`。
    *   所以结果为 `2x²`。
4.  **求逆元**：使用扩展欧几里得算法，在 `F₃[x]` 上求 `f(x)=x²+x+1` 关于 `m(x)` 的逆元。
    *   `m(x) = (x+2)f(x) + (2x)`。
    *   `f(x) = (2x+2)(2x) + 1`。
    *   反向代入：`1 = f(x) - (2x+2)(2x) = f(x) + (x+1)(2x)`。
    *   将 `2x = m(x) - (x+2)f(x)` 代入：`1 = f(x) + (x+1)[m(x) - (x+2)f(x)] = (x+1)m(x) + [1 - (x+1)(x+2)]f(x)`。
    *   计算 `[1 - (x+1)(x+2)] = 1 - (x²+0x+2) = -x² - 1 ≡ 2x² + 2 (mod 3)`。
    *   所以在域 `F₃[x]/<m(x)>` 中，有 `(2x²+2) · f(x) ≡ 1`。故逆元为 `2x²+2`。
5.  **计算高次幂**：利用有限域的阶。`F_{27}^*` 是27阶乘法群，任何非零元素的阶整除 `26`。但更简单的是利用 `m(x)` 的关系：`x³ ≡ -2x - 2 ≡ x + 1 (mod m(x), 模3)`，因为 `-2≡1`。
    *   `x^29 = x^(27+2) = (x^27) * (x^2)`。
    *   在 `F_{27}` 中，非零元素满足 `a^27 = a`（费马小定理的推广）。所以 `x^27 = x`。
    *   因此 `x^29 = x * x² = x³`。
    *   根据上面化简规则，`x³ ≡ x + 1`。所以 `x^29 ≡ x + 1`。



# 知识点
# 一、辗转相除法（欧几里得算法）
## 1. 基础理论
*   **核心目的**：求两个整数的最大公约数（gcd），即能同时整除两个数的最大正整数。
*   **核心原理**：带余除法的迭代应用 —— 对任意整数 \(a > b > 0\)，存在唯一整数 q（商）和 r（余数）满足 \(a = bq + r\)（\(0 \leq r < b\)），且 \(\gcd(a, b) = \gcd(b, r)\)。
*   **终止条件**：当余数 \(r = 0\) 时，此时的除数就是最大公约数。

## 2. 解题步骤（以求 \(\gcd(a, b)\) 为例，\(a > b\)）
1.  第一步：用较大数 a 除以较小数 b，得余数 \(r_1\)（\(a = bq_1 + r_1\)，\(0 \leq r_1 < b\)）；
2.  第二步：若 \(r_1 = 0\)，则 \(\gcd(a, b) = b\)，结束；若 \(r_1 \neq 0\)，用 b 除以 \(r_1\)，得余数 \(r_2\)（\(b = r_1q_2 + r_2\)，\(0 \leq r_2 < r_1\)）；
3.  第三步：重复 “除数变被除数、余数变除数”，直到余数为 0，最后一个非零余数即为 \(\gcd(a, b)\)。

## 3. 通俗例子：求 \(\gcd(105, 24)\)
*   第一步：\(105 = 24 \times 4 + 9\)（\(q_1=4\)，\(r_1=9 \neq 0\)）；
*   第二步：\(24 = 9 \times 2 + 6\)（\(q_2=2\)，\(r_2=6 \neq 0\)）；
*   第三步：\(9 = 6 \times 1 + 3\)（\(q_3=1\)，\(r_3=3 \neq 0\)）；
*   第四步：\(6 = 3 \times 2 + 0\)（\(r_4=0\)）；
*   结论：\(\gcd(105, 24) = 3\)。

# 二、欧拉定理
## 1. 基础理论
*   **前置概念**：欧拉函数 \(\varphi(n)\)—— 小于 n 且与 n 互质的正整数的个数（互质：两数最大公约数为 1）。
    *   若 n 是质数 p，则 \(\varphi(p) = p-1\)（1~p-1 都与 p 互质）；
    *   若 \(n = p^k\)（p 为质数，k≥1），则 \(\varphi(p^k) = p^k - p^{k-1} = p^{k-1}(p-1)\)；
    *   若 \(n = ab\) 且 \(\gcd(a,b)=1\)，则 \(\varphi(ab) = \varphi(a)\varphi(b)\)（积性函数）。
*   **定理内容**：若 \(\gcd(a, n) = 1\)（a 与 n 互质），则 \(a^{\varphi(n)} \equiv 1 \pmod{n}\)（读作 “a 的 φ(n) 次方同余于 1 模 n”，即 \(a^{\varphi(n)} - 1\) 能被 n 整除）。
*   **核心用途**：简化模运算中的高次幂计算。

## 2. 解题步骤（以计算 \(a^k \mod n\) 为例，\(\gcd(a,n)=1\)）
1.  第一步：计算欧拉函数 \(\varphi(n)\)（先分解 n 的质因数，再用欧拉函数公式）；
2.  第二步：利用欧拉定理化简指数 ——\(k = q \cdot \varphi(n) + r\)（\(0 \leq r < \varphi(n)\)），则 \(a^k \equiv a^r \pmod{n}\)；
3.  第三步：计算 \(a^r \mod n\)，得到结果。

## 3. 通俗例子：计算 \(3^{100} \mod 7\)
1.  第一步：n=7 是质数，\(\varphi(7) = 7-1 = 6\)；
2.  第二步：验证 \(\gcd(3,7)=1\)，满足欧拉定理；化简指数：\(100 = 16 \times 6 + 4\)，故 \(3^{100} \equiv 3^4 \pmod{7}\)；
3.  第三步：计算 \(3^4 = 81\)，\(81 \mod 7 = 4\)（因为 7×11=77，81-77=4）；
4.  结论：\(3^{100} \mod 7 = 4\)。

# 三、中国剩余定理（CRT）
## 1. 基础理论
*   **核心目的**：求解同余方程组（多个 “\(x \equiv a_i \pmod{m_i}\)” 的联立方程）。
*   **定理条件**：模数 \(m_1, m_2, ..., m_k\) 两两互质（\(\gcd(m_i, m_j) = 1\)，\(i \neq j\)）。
*   **定理结论**：方程组有唯一解 \(x \equiv X \pmod{M}\)，其中 \(M = m_1m_2...m_k\)（模数乘积），\(X = a_1M_1M_1^{-1} + a_2M_2M_2^{-1} + ... + a_kM_kM_k^{-1}\)（\(M_i = M/m_i\)，\(M_i^{-1}\) 是 \(M_i\) 模 \(m_i\) 的逆元，即 \(M_iM_i^{-1} \equiv 1 \pmod{m_i}\)）。

## 2. 解题步骤（以解方程组 \(\begin{cases} x \equiv a_1 \pmod{m_1} \\ x \equiv a_2 \pmod{m_2} \\ ... \\ x \equiv a_k \pmod{m_k} \end{cases}\) 为例，模数两两互质）
1.  第一步：计算总模数 \(M = m_1 \times m_2 \times ... \times m_k\)；
2.  第二步：对每个 i，计算 \(M_i = M / m_i\)（即除 \(m_i\) 外所有模数的乘积）；
3.  第三步：对每个 i，求 \(M_i\) 模 \(m_i\) 的逆元 \(M_i^{-1}\)（满足 \(M_i \times M_i^{-1} \equiv 1 \pmod{m_i}\)，可通过辗转相除法求解）；
4.  第四步：计算 \(X = (a_1M_1M_1^{-1} + a_2M_2M_2^{-1} + ... + a_kM_kM_k^{-1}) \mod M\)；
5.  结论：X 是方程组的最小正整数解，所有解可表示为 \(x = X + tM\)（t 为整数）。

## 3. 通俗例子：解方程组 \(\begin{cases} x \equiv 2 \pmod{3} \\ x \equiv 3 \pmod{5} \\ x \equiv 2 \pmod{7} \end{cases}\)
1.  第一步：模数 3、5、7 两两互质，\(M = 3 \times 5 \times 7 = 105\)；
2.  第二步：计算 \(M_1 = 105/3 = 35\)，\(M_2 = 105/5 = 21\)，\(M_3 = 105/7 = 15\)；
3.  第三步：求逆元：
    *   \(M_1 \mod 3 = 35 \mod 3 = 2\)，需找 \(2 \times x \equiv 1 \pmod{3}\)，得 \(x=2\)（因为 2×2=4≡1 mod3），故 \(M_1^{-1}=2\)；
    *   \(M_2 \mod 5 = 21 \mod 5 = 1\)，需找 \(1 \times x \equiv 1 \pmod{5}\)，得 \(x=1\)，故 \(M_2^{-1}=1\)；
    *   \(M_3 \mod 7 = 15 \mod 7 = 1\)，需找 \(1 \times x \equiv 1 \pmod{7}\)，得 \(x=1\)，故 \(M_3^{-1}=1\)；
4.  第四步：计算 \(X = (2×35×2 + 3×21×1 + 2×15×1) \mod 105 = (140 + 63 + 30) \mod 105 = 233 \mod 105 = 23\)；
5.  结论：方程组的最小正整数解为 23，所有解为 \(x = 23 + 105t\)（t 为整数）。

# 四、求原根
## 1. 基础理论
*   **前置概念**：元素的阶 —— 设 \(\gcd(a, m) = 1\)，最小的正整数 d 满足 \(a^d \equiv 1 \pmod{m}\)，则 d 是 a 模 m 的阶，记为 \(\text{ord}_m(a)\)。
*   **原根定义**：若 \(\text{ord}_m(a) = \varphi(m)\)（阶等于欧拉函数值），则 a 是模 m 的原根。
*   **原根存在条件**：模 m 存在原根的充要条件是 \(m = 1, 2, 4, p^k, 2p^k\)（其中 p 是奇质数，\(k \geq 1\)）。

## 2. 解题步骤（以求模 m 的原根为例，m 满足原根存在条件）
1.  第一步：计算 \(\varphi(m)\)，并对 \(\varphi(m)\) 分解质因数：\(\varphi(m) = q_1^{k_1} q_2^{k_2} ... q_t^{k_t}\)；
2.  第二步：从小到大枚举正整数 a（从 2 开始，满足 \(\gcd(a, m) = 1\)）；
3.  第三步：对每个枚举的 a，验证所有 \(q_i\)（\(\varphi(m)\) 的质因数），是否满足 \(a^{\varphi(m)/q_i} \not\equiv 1 \pmod{m}\)（若所有 \(q_i\) 都满足，则 \(\text{ord}_m(a) = \varphi(m)\)）；
4.  第四步：第一个满足条件的 a 即为模 m 的最小原根，后续可通过 \(a^k \mod m\)（\(\gcd(k, \varphi(m))=1\)）生成其他原根。

## 3. 通俗例子：求模 7 的原根
1.  第一步：\(m=7\) 是奇质数，满足原根存在条件；\(\varphi(7) = 6\)，分解质因数：\(6 = 2 \times 3\)（质因数 \(q_1=2\)，\(q_2=3\)）；
2.  第二步：枚举 \(a=2\)（\(\gcd(2,7)=1\)）；
3.  第三步：验证：\(\varphi(m)/q_1 = 6/2 = 3\)，计算 \(2^3 = 8 \equiv 1 \pmod{7}\)—— 不满足 “≠1”，故 \(a=2\) 不是原根；
4.  第四步：枚举 \(a=3\)（\(\gcd(3,7)=1\)）；
5.  第五步：验证：\(3^{6/2} = 3^3 = 27 \equiv 6 \not\equiv 1 \pmod{7}\)；\(3^{6/3} = 3^2 = 9 \equiv 2 \not\equiv 1 \pmod{7}\)；所有质因数都满足 “≠1”，故 \(\text{ord}_7(3) = 6 = \varphi(7)\)；
6.  结论：3 是模 7 的原根（最小原根）；其他原根可通过 \(3^k \mod 7\)（\(\gcd(k,6)=1\)，k=1,5）生成：\(3^1=3\)，\(3^5=243 \equiv 5 \pmod{7}\)，故模 7 的原根为 3、5。

# 五、勒让德符号
## 1. 基础理论
*   **核心定义**：设 p 是奇质数，对任意整数 a，勒让德符号 \(\left( \frac{a}{p} \right)\) 定义为：
    *   \(\left( \frac{a}{p} \right) = 1\)，若 a 是模 p 的二次剩余（存在 x 使 \(x^2 \equiv a \pmod{p}\)）且 \(a \not\equiv 0 \pmod{p}\)；
    *   \(\left( \frac{a}{p} \right) = -1\)，若 a 是模 p 的二次非剩余（不存在这样的 x）；
    *   \(\left( \frac{a}{p} \right) = 0\)，若 \(a \equiv 0 \pmod{p}\)。
*   **核心公式与性质**：
    *   欧拉判别法：\(\left( \frac{a}{p} \right) \equiv a^{\frac{p-1}{2}} \pmod{p}\)；
    *   对称性：\(\left( \frac{a}{p} \right) = \left( \frac{a \mod p}{p} \right)\)；
    *   可乘性：\(\left( \frac{ab}{p} \right) = \left( \frac{a}{p} \right) \left( \frac{b}{p} \right)\)；
    *   常数项：\(\left( \frac{1}{p} \right) = 1\)，\(\left( \frac{-1}{p} \right) = (-1)^{\frac{p-1}{2}}\)；
    *   二次互反律：设 \(p, q\) 是不同的奇质数，则 \(\left( \frac{p}{q} \right) = \left( \frac{q}{p} \right) (-1)^{\frac{p-1}{2} \cdot \frac{q-1}{2}}\)。

## 2. 解题步骤（以计算 \(\left( \frac{a}{p} \right)\) 为例，p 是奇质数）
1.  第一步：化简 \(a \mod p\)，使 a 落在 \([0, p-1]\) 内（利用对称性）；
2.  第二步：若 \(a \equiv 0 \pmod{p}\)，则 \(\left( \frac{a}{p} \right) = 0\)，结束；
3.  第三步：分解 a 为质因数（含 - 1 和 2），利用可乘性拆分符号（如 \(\left( \frac{12}{7} \right) = \left( \frac{4 \times 3}{7} \right) = \left( \frac{4}{7} \right) \left( \frac{3}{7} \right)\)）；
4.  第四步：对质数因子，利用二次互反律和已知性质（如 \(\left( \frac{2}{p} \right) = (-1)^{\frac{p^2-1}{8}}\)）化简；
5.  第五步：结合欧拉判别法或已知结果，计算最终符号（1、-1 或 0）。

## 3. 通俗例子：计算 \(\left( \frac{5}{7} \right)\)
1.  第一步：\(5 \mod 7 = 5\)，\(\gcd(5,7)=1\)，非 0；
2.  第二步：利用二次互反律：\(p=5\)，\(q=7\) 都是奇质数，故 \(\left( \frac{5}{7} \right) = \left( \frac{7}{5} \right) (-1)^{\frac{5-1}{2} \cdot \frac{7-1}{2}}\)；
3.  第三步：计算指数部分：\(\frac{4}{2} \times \frac{6}{2} = 2 \times 3 = 6\)，\((-1)^6 = 1\)；
4.  第四步：化简 \(\left( \frac{7}{5} \right) = \left( \frac{7 \mod 5}{5} \right) = \left( \frac{2}{5} \right)\)；
5.  第五步：利用 \(\left( \frac{2}{p} \right) = (-1)^{\frac{p^2-1}{8}}\)，\(p=5\) 时，\(\frac{25-1}{8} = 3\)，\((-1)^3 = -1\)，故 \(\left( \frac{2}{5} \right) = -1\)；
6.  第六步：综上，\(\left( \frac{5}{7} \right) = -1 \times 1 = -1\)；
7.  结论：5 是模 7 的二次非剩余（即不存在 x 使 \(x^2 \equiv 5 \pmod{7}\)）。

# 六、有限域计算
## 1. 基础理论
*   **有限域定义**：元素个数有限的域（满足加法、乘法封闭，有逆元等域公理），记为 \(\text{GF}(q)\)，其中 \(q = p^n\)（p 是质数，称为域的特征；\(n \geq 1\) 是正整数）。
*   **核心类型**：
    *   当 \(n=1\) 时，\(\text{GF}(p) = \{0, 1, 2, ..., p-1\}\)，即模 p 的剩余类域（运算为模 p 的加减乘除）；
    *   当 \(n>1\) 时，\(\text{GF}(p^n)\) 由 \(\text{GF}(p)[x]\)（GF (p) 上的多项式环）中次数为 n 的不可约多项式 \(f(x)\) 构造，元素形式为 \(a_0 + a_1x + ... + a_{n-1}x^{n-1}\)（\(a_i \in \text{GF}(p)\)），运算为多项式加减乘后模 \(f(x)\)。

## 2. 解题步骤（分两类场景）
*   **场景 1：GF (p) 中的计算（p 为质数）**
    *   加法：\(a + b \equiv (a + b) \mod p\)；
    *   减法：\(a - b \equiv (a - b) \mod p\)（可转化为 \(a + (p - b) \mod p\)）；
    *   乘法：\(a \times b \equiv (a \times b) \mod p\)；
    *   除法：\(a \div b \equiv a \times b^{-1} \mod p\)（\(b \neq 0\)，\(b^{-1}\) 是 b 模 p 的逆元，可通过辗转相除法求解）。

*   **场景 2：GF (pⁿ) 中的计算（n>1，p 为质数，f (x) 为 GF (p) 上 n 次不可约多项式）**
    *   元素表示：每个元素是次数≤n-1 的多项式 \(g(x) = a_0 + a_1x + ... + a_{n-1}x^{n-1}\)（\(a_i \in \{0,1,...,p-1\}\)）；
    *   加法：对应系数相加，模 p（\((a_0 + a_1x + ...) + (b_0 + b_1x + ...) = (a_0+b_0) + (a_1+b_1)x + ... \mod p\)）；
    *   乘法：多项式相乘后，用 \(f(x)\) 除得余式（余式次数≤n-1），系数模 p；
    *   除法：\(g(x) \div h(x) \equiv g(x) \times h(x)^{-1} \mod f(x)\)（\(h(x) \neq 0\)，逆元可通过扩展欧几里得算法求解多项式逆）。

## 3. 通俗例子
*   **例子 1：GF (5) 中的计算**
    *   加法：\(3 + 4 = 7 \equiv 2 \pmod{5}\)；
    *   减法：\(2 - 4 = -2 \equiv 3 \pmod{5}\)（或 \(2 + (5-4) = 3\)）；
    *   乘法：\(3 \times 4 = 12 \equiv 2 \pmod{5}\)；
    *   除法：\(3 \div 4 \equiv 3 \times 4^{-1} \pmod{5}\)—— 找 4 的逆元：\(4 \times 4 = 16 \equiv 1 \pmod{5}\)，故 \(4^{-1}=4\)，结果为 \(3 \times 4 = 12 \equiv 2 \pmod{5}\)。

*   **例子 2：GF (2³) 中的计算（p=2，n=3，不可约多项式 \(f(x) = x^3 + x + 1\)）**
    *   元素表示：所有次数≤2 的二元多项式（系数 0 或 1），共 8 个元素：0, 1, x, x+1, x², x²+1, x²+x, x²+x+1；
    *   加法（系数模 2，1+1=0）：\((x² + x + 1) + (x + 1) = x² + (x+x) + (1+1) = x² \pmod{2}\)；
    *   乘法（多项式相乘后模 \(f(x)\)，\(x^3 \equiv x + 1 \pmod{f(x)}\)，因 \(x^3 + x + 1 \equiv 0\)）：计算 \((x² + 1)(x + 1)\)；
        1.  第一步：多项式相乘：\(x² \cdot x + x² \cdot 1 + 1 \cdot x + 1 \cdot 1 = x³ + x² + x + 1\)；
        2.  第二步：模 \(f(x)\) 化简：\(x³ = x + 1\)，代入得 \((x + 1) + x² + x + 1 = x² + (x + x) + (1 + 1) = x² \pmod{2}\)；
    *   结论：\((x² + 1)(x + 1) \equiv x² \pmod{f(x)}\)。